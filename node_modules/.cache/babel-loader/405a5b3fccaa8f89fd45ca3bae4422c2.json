{"ast":null,"code":"import \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/breadcrumb/style\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport _classCallCheck from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"E:\\\\project\\\\environment-web\\\\src\\\\pages\\\\inventory\\\\inventory\\\\List.js\";\nimport React, { Component } from 'react';\nimport Table from '@/components/table';\nimport Button from '@/components/button'; // import Statistics from './Statistics'\n\nvar List = /*#__PURE__*/function (_Component) {\n  _inherits(List, _Component);\n\n  function List(props) {\n    var _this;\n\n    _classCallCheck(this, List);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(List).call(this, props));\n    _this.tableRef = React.createRef();\n\n    _this.getUnitList = function () {\n      React.axios.post('api/wmsType/tmaterialtype/queryMaterialTypeList?number=unit', null, function (res) {\n        var obj = {};\n        res.data.forEach(function (item) {\n          obj[item.id] = item.name;\n        });\n\n        _this.setState({\n          units: obj\n        });\n      });\n    };\n\n    _this.getWarehouseList = function () {\n      React.axios.get('api/wms/twarehouse/list', {\n        page: 1,\n        limit: 100\n      }, function (res) {\n        _this.setState({\n          WarehouseList: res.data.data\n        });\n      });\n    };\n\n    _this.getTypeList = function () {\n      React.axios.post(\"api/wmsType/tmaterialtype/queryMaterialTypeList?number=\" + React.enums.goodTypeCode, null, function (res) {\n        _this.setState({\n          typeList: res.data\n        });\n      });\n    };\n\n    _this.openDetail = function (id) {\n      _this.props.history.push(\"/\" + React.Version + \"/inventory/inventory/detail/\" + id);\n    };\n\n    _this.openQR = function (data) {\n      var params = {\n        address: \"\".concat(data.houseName, \" / \").concat(data.locationName, \" / \").concat(data.shelvesName),\n        content: data.number,\n        number: data.number\n      };\n      React.axios.get(\"api/wms/twarehousestock/creageBarcodeBase64\", params, function (res) {\n        _Modal.confirm({\n          title: data.name,\n          icon: \"\",\n          cancelText: \"关闭\",\n          okText: \"下载二维码\",\n          content: /*#__PURE__*/React.createElement(\"div\", {\n            style: {\n              textAlign: 'center'\n            },\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 26\n            }\n          }, /*#__PURE__*/React.createElement(\"img\", {\n            alt: \"\",\n            src: res.data,\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 61\n            }\n          })),\n          onOk: function onOk() {\n            React.axios.download(res.data);\n          }\n        });\n      });\n    };\n\n    _this.submit = function (values) {\n      _this.tableRef.reload(values);\n    };\n\n    _this.tableRef = React.createRef();\n\n    _this.tableReload = function () {\n      var params = _this.state.params;\n\n      _this.tableRef.reload(params);\n    };\n\n    _this.formRef = React.createRef();\n\n    _this.reset = function () {\n      _this.formRef.current.resetFields();\n\n      new Promise(function (resolve) {\n        _this.setState({\n          params: {\n            name: \"\",\n            gtype: \"\",\n            houseNumber: \"\"\n          }\n        });\n\n        resolve();\n      }).then(function () {\n        _this.tableReload();\n      });\n    };\n\n    _this.exportQRcode = function () {\n      React.message.error('暂未实现');\n    };\n\n    _this.state = {\n      WarehouseList: [],\n      typeList: [],\n      units: {}\n    };\n    return _this;\n  }\n\n  _createClass(List, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getUnitList();\n      this.getWarehouseList();\n      this.getTypeList();\n    } // 获取计量单位\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var columns = [{\n        title: \"物料名称\",\n        key: \"name\",\n        dataIndex: \"name\"\n      }, {\n        title: \"编号\",\n        key: \"number\",\n        dataIndex: \"number\"\n      }, {\n        title: \"物料种类\",\n        key: \"gname\",\n        dataIndex: \"gname\",\n        render: function render(text, record) {\n          var gname = \"\";\n\n          _this2.state.typeList.forEach(function (item) {\n            if (item.id === record.gtype) {\n              gname = item.name;\n              return;\n            }\n\n            ;\n          });\n\n          return gname;\n        }\n      }, {\n        title: \"库存数量\",\n        key: \"num\",\n        dataIndex: \"num\"\n      }, {\n        title: \"单价\",\n        key: \"price\",\n        dataIndex: \"price\",\n        render: function render(text, record) {\n          return \"\".concat(record.price, \"\\u5143/\").concat(_this2.state.units[record.unit]);\n        }\n      }, {\n        title: \"所在位置\",\n        render: function render(text, record) {\n          return /*#__PURE__*/React.createElement(_Breadcrumb, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(_Breadcrumb.Item, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 21\n            }\n          }, record.houseName), /*#__PURE__*/React.createElement(_Breadcrumb.Item, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 21\n            }\n          }, record.locationName), /*#__PURE__*/React.createElement(_Breadcrumb.Item, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 21\n            }\n          }, record.shelvesName));\n        }\n      }, {\n        title: \"备注\",\n        key: \"remark\",\n        dataIndex: \"remark\"\n      }, {\n        title: \"操作\",\n        width: \"150px\",\n        align: 'center',\n        render: function render(text, record) {\n          return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n            type: \"link\",\n            size: \"small\",\n            onClick: _this2.openDetail.bind(_this2, record.id),\n            icon: \"info\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 21\n            }\n          }, \"\\u8BE6\\u60C5\"), /*#__PURE__*/React.createElement(Button, {\n            type: \"link\",\n            size: \"small\",\n            onClick: _this2.openQR.bind(_this2, record),\n            icon: \"info\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 21\n            }\n          }, \"\\u4E8C\\u7EF4\\u7801\"));\n        }\n      }];\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(_Form, {\n        ref: this.formRef,\n        className: \"query-tools\",\n        layout: \"inline\",\n        onFinish: this.submit,\n        onReset: this.reset,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        name: \"name\",\n        initialValue: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        placeholder: \"\\u7269\\u6599\\u540D\\u79F0\",\n        allowClear: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        name: \"gtype\",\n        initialValue: [],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Select, {\n        placeholder: \"\\u7269\\u6599\\u79CD\\u7C7B\",\n        style: {\n          width: '174px'\n        },\n        allowClear: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 25\n        }\n      }, this.state.typeList.map(function (res) {\n        return /*#__PURE__*/React.createElement(_Select.Option, {\n          key: res.id,\n          value: res.id,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 59\n          }\n        }, res.name);\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        name: \"houseNumber\",\n        initialValue: [],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Select, {\n        placeholder: \"\\u4ED3\\u5E93\",\n        style: {\n          width: '174px'\n        },\n        allowClear: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 25\n        }\n      }, this.state.WarehouseList.map(function (res) {\n        return /*#__PURE__*/React.createElement(_Select.Option, {\n          key: res.id,\n          value: res.number,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 64\n          }\n        }, res.name);\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        type: \"primary\",\n        icon: \"search\",\n        htmlType: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 25\n        }\n      }, \"\\u67E5\\u8BE2\")), /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        htmlType: \"reset\",\n        icon: \"chongzhi\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 25\n        }\n      }, \"\\u91CD\\u7F6E\")), /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        type: \"primary\",\n        icon: \"info\",\n        onClick: this.exportQRcode,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 25\n        }\n      }, \"\\u5BFC\\u51FA\\u4E8C\\u7EF4\\u7801\"))), /*#__PURE__*/React.createElement(Table, {\n        rowKey: \"id\",\n        columns: columns,\n        method: \"get\",\n        url: \"api/wms/twarehousestock/list\",\n        onRef: function onRef(ref) {\n          return _this2.tableRef = ref;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 17\n        }\n      }));\n    }\n  }]);\n\n  return List;\n}(Component);\n\nexport default List;","map":{"version":3,"sources":["E:/project/environment-web/src/pages/inventory/inventory/List.js"],"names":["React","Component","Table","Button","List","props","tableRef","createRef","getUnitList","axios","post","res","obj","data","forEach","item","id","name","setState","units","getWarehouseList","get","page","limit","WarehouseList","getTypeList","enums","goodTypeCode","typeList","openDetail","history","push","Version","openQR","params","address","houseName","locationName","shelvesName","content","number","confirm","title","icon","cancelText","okText","textAlign","onOk","download","submit","values","reload","tableReload","state","formRef","reset","current","resetFields","Promise","resolve","gtype","houseNumber","then","exportQRcode","message","error","columns","key","dataIndex","render","text","record","gname","price","unit","width","align","bind","map","ref"],"mappings":"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","sourcesContent":["import React,{Component} from 'react';\r\nimport {Form,Input,Select,Breadcrumb,Modal} from 'antd';\r\nimport Table from '@/components/table';\r\nimport Button from '@/components/button';\r\n// import Statistics from './Statistics'\r\nclass List extends Component {\r\n    tableRef = React.createRef();\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            WarehouseList: [],\r\n            typeList: [],\r\n            units: {}\r\n        }\r\n    }\r\n    componentDidMount(){\r\n        this.getUnitList();\r\n        this.getWarehouseList();\r\n        this.getTypeList();\r\n    }\r\n    // 获取计量单位\r\n    getUnitList=()=>{\r\n        React.axios.post('api/wmsType/tmaterialtype/queryMaterialTypeList?number=unit',null,res=>{\r\n            let obj = {};\r\n            res.data.forEach(item=>{\r\n                obj[item.id] = item.name;\r\n            })\r\n            this.setState({units: obj});\r\n        })\r\n    }\r\n    // 获取仓库下拉框数据\r\n    getWarehouseList=()=>{\r\n        React.axios.get('api/wms/twarehouse/list',{page:1,limit:100},res=>{\r\n            this.setState({WarehouseList: res.data.data});\r\n        });\r\n    };\r\n    // 获取仓库下拉框数据\r\n    getTypeList=()=>{\r\n        React.axios.post(\"api/wmsType/tmaterialtype/queryMaterialTypeList?number=\"+React.enums.goodTypeCode,null,res=>{\r\n            this.setState({typeList: res.data});\r\n        });\r\n    };\r\n    // 详情\r\n    openDetail=(id)=>{\r\n        this.props.history.push(\"/\"+React.Version+\"/inventory/inventory/detail/\"+id);\r\n    };\r\n    // 二位码\r\n    openQR=(data)=>{\r\n        const params = {\r\n            address: `${data.houseName} / ${data.locationName} / ${data.shelvesName}`,\r\n            content: data.number,\r\n            number: data.number\r\n        }\r\n        React.axios.get(\"api/wms/twarehousestock/creageBarcodeBase64\",params,res=>{\r\n            Modal.confirm({\r\n                title: data.name,\r\n                icon:\"\",\r\n                cancelText:\"关闭\",\r\n                okText:\"下载二维码\",\r\n                content: <div style={{textAlign: 'center'}}><img alt=\"\" src={res.data} /></div>,\r\n                onOk: ()=>{\r\n                    React.axios.download(res.data);\r\n                }\r\n            });\r\n        });\r\n        \r\n    };\r\n    // 搜索\r\n    submit=(values)=>{\r\n        this.tableRef.reload(values);\r\n    };\r\n\r\n    tableRef = React.createRef();\r\n    /**\r\n     * @todo 搜索与刷新\r\n     */\r\n    tableReload = () => {\r\n        const {params} = this.state;\r\n        this.tableRef.reload(params);\r\n    };\r\n\r\n    formRef = React.createRef();\r\n    /**\r\n     * @todo 重置搜索\r\n     */\r\n    reset = () => {\r\n        this.formRef.current.resetFields();\r\n        new Promise((resolve) => {\r\n            this.setState({params:{name:\"\",gtype:\"\",houseNumber:\"\"}});\r\n            resolve();\r\n        }).then(() => {\r\n            this.tableReload();\r\n        });\r\n    };\r\n\r\n    // 导出二维码\r\n    exportQRcode=()=>{\r\n        React.message.error('暂未实现');\r\n    }\r\n\r\n    render() {\r\n        const columns = [\r\n            {\r\n                title:\"物料名称\",\r\n                key:\"name\",\r\n                dataIndex:\"name\",\r\n            },\r\n            {\r\n                title:\"编号\",\r\n                key:\"number\",\r\n                dataIndex:\"number\",\r\n            },\r\n            {\r\n                title:\"物料种类\",\r\n                key:\"gname\",\r\n                dataIndex:\"gname\",\r\n                render:(text,record) => {\r\n                    let gname = \"\";\r\n                    this.state.typeList.forEach((item) => {\r\n                        if(item.id === record.gtype){\r\n                            gname = item.name;\r\n                            return;\r\n                        };\r\n                    });\r\n                    return gname;\r\n                },\r\n            },\r\n            {\r\n                title:\"库存数量\",\r\n                key:\"num\",\r\n                dataIndex:\"num\",\r\n            },\r\n            {\r\n                title:\"单价\",\r\n                key:\"price\",\r\n                dataIndex:\"price\",\r\n                render:(text,record) => {\r\n                    return `${record.price}元/${this.state.units[record.unit]}`;\r\n                },\r\n            },\r\n            {\r\n                title:\"所在位置\",\r\n                render:(text,record) => <Breadcrumb>\r\n                    <Breadcrumb.Item>{record.houseName}</Breadcrumb.Item>\r\n                    <Breadcrumb.Item>{record.locationName}</Breadcrumb.Item>\r\n                    <Breadcrumb.Item>{record.shelvesName}</Breadcrumb.Item>\r\n                </Breadcrumb>\r\n            },\r\n            {\r\n                title:\"备注\",\r\n                key:\"remark\",\r\n                dataIndex:\"remark\",\r\n            },\r\n            {\r\n                title:\"操作\",\r\n                width:\"150px\",\r\n                align: 'center',\r\n                render:(text,record) => <>\r\n                    <Button type=\"link\" size=\"small\" onClick={this.openDetail.bind(this,record.id)} icon=\"info\">详情</Button>\r\n                    <Button type=\"link\" size=\"small\" onClick={this.openQR.bind(this,record)} icon=\"info\">二维码</Button>\r\n                </>,\r\n            },\r\n        ]; \r\n        return (\r\n            <>\r\n                <Form ref={this.formRef} className=\"query-tools\" layout=\"inline\" onFinish={this.submit} onReset={this.reset}>\r\n                    <Form.Item name=\"name\" initialValue=\"\">\r\n                        <Input placeholder=\"物料名称\" allowClear/>\r\n                    </Form.Item>\r\n                    <Form.Item name=\"gtype\" initialValue={[]}>\r\n                        <Select placeholder=\"物料种类\" style={{width: '174px'}} allowClear>\r\n                            {this.state.typeList.map(res=><Select.Option key={res.id} value={res.id}>{res.name}</Select.Option>)}\r\n                        </Select>\r\n                    </Form.Item>\r\n                    <Form.Item name=\"houseNumber\" initialValue={[]}>\r\n                        <Select placeholder=\"仓库\" style={{width: '174px'}} allowClear>\r\n                            {this.state.WarehouseList.map(res=><Select.Option key={res.id} value={res.number}>{res.name}</Select.Option>)}\r\n                        </Select>\r\n                    </Form.Item>\r\n                    <Form.Item>\r\n                        <Button type=\"primary\" icon=\"search\" htmlType=\"submit\">查询</Button>\r\n                    </Form.Item>\r\n                    <Form.Item>\r\n                        <Button htmlType=\"reset\" icon=\"chongzhi\">重置</Button>\r\n                    </Form.Item>\r\n                    <Form.Item>\r\n                        <Button type=\"primary\" icon=\"info\" onClick={this.exportQRcode}>导出二维码</Button>\r\n                    </Form.Item>\r\n                </Form>\r\n                <Table\r\n                    rowKey=\"id\"\r\n                    columns={columns}\r\n                    method=\"get\"\r\n                    url=\"api/wms/twarehousestock/list\"\r\n                    onRef={ref=>this.tableRef = ref}\r\n                />\r\n                {/* <Tabs>\r\n                    <Tabs.TabPane\r\n                        tab=\"列表\"\r\n                        key=\"1\"\r\n                    >\r\n                    </Tabs.TabPane>\r\n                    <Tabs.TabPane\r\n                        tab=\"统计\"\r\n                        key=\"2\"\r\n                    >\r\n                        <Statistics />\r\n                    </Tabs.TabPane>\r\n                </Tabs> */}\r\n            </>\r\n        );\r\n    }\r\n}\r\n \r\nexport default List;"]},"metadata":{},"sourceType":"module"}