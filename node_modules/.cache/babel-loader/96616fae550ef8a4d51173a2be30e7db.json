{"ast":null,"code":"import _classCallCheck from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\project\\\\environment-web\\\\src\\\\pages\\\\system\\\\menu\\\\List.js\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport React, { Component } from 'react';\nimport { withRouter } from \"react-router-dom\";\nimport Button from '@/components/button';\nimport Table from '@/components/table';\nimport Edit from './Edit';\n\nvar List = /*#__PURE__*/function (_Component) {\n  _inherits(List, _Component);\n\n  function List(props) {\n    var _this;\n\n    _classCallCheck(this, List);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(List).call(this, props));\n\n    _this.addMenu = function (_ref) {\n      var parentId = _ref.parentId,\n          menuId = _ref.menuId;\n\n      _this.setState({\n        parentId: parentId || undefined,\n        menuId: menuId,\n        editDialog: true\n      });\n    };\n\n    _this.delMenu = function (_ref2) {\n      var menuId = _ref2.menuId,\n          children = _ref2.children;\n\n      if (children) {\n        React.message.warning('该菜单下有子菜单不能直接删除');\n        return;\n      }\n\n      React.message.confirm('确定删除该菜单？', function () {\n        React.axios.post(\"sys/menu/delete/\".concat(menuId), null, function () {\n          React.message.success('删除成功');\n\n          _this.getList();\n        });\n      });\n    };\n\n    _this.getList = function () {\n      React.axios.get('sys/menu/menuTree', null, function (res) {\n        _this.setState({\n          data: res.data\n        });\n      });\n    };\n\n    _this.delEmptyFiled = function (data) {\n      var _iterator = _createForOfIteratorHelper(data),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var item = _step.value;\n\n          if (item.children.length === 0) {\n            item.children = null;\n          } else {\n            _this.delEmptyFiled(item.children);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return data;\n    };\n\n    _this.state = {\n      editDialog: false,\n      data: []\n    };\n    return _this;\n  }\n\n  _createClass(List, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getList();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var columns = [{\n        title: '菜单名称',\n        dataIndex: 'name',\n        key: 'name',\n        width: '200px'\n      }, {\n        title: '图标',\n        width: '100px',\n        align: 'center',\n        render: function render(text, record) {\n          return /*#__PURE__*/React.createElement(React.IconFont, {\n            style: {\n              fontSize: '22px'\n            },\n            type: record.icon,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 41\n            }\n          });\n        }\n      }, {\n        title: '类型',\n        dataIndex: 'type',\n        key: 'type',\n        width: '100px',\n        render: function render(text, record) {\n          return /*#__PURE__*/React.createElement(\"span\", {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 41\n            }\n          }, React.enums.menuType[record.type]);\n        }\n      }, {\n        title: '排序',\n        dataIndex: 'orderNum',\n        key: 'orderNum',\n        width: '100px'\n      }, {\n        title: '路由地址',\n        dataIndex: 'url',\n        key: 'url'\n      }, {\n        title: '权限标识',\n        dataIndex: 'perms',\n        key: 'perms',\n        width: '300px'\n      }, {\n        title: '操作',\n        width: '240px',\n        align: 'center',\n        render: function render(text, record) {\n          return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n            type: \"link\",\n            size: \"small\",\n            onClick: _this2.addMenu.bind(_this2, {\n              parentId: record.menuId\n            }),\n            icon: \"add\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 21\n            }\n          }, \"\\u6DFB\\u52A0\\u5B50\\u83DC\\u5355\"), /*#__PURE__*/React.createElement(Button, {\n            type: \"link\",\n            size: \"small\",\n            onClick: _this2.addMenu.bind(_this2, {\n              parentId: record.parentId,\n              menuId: record.menuId\n            }),\n            icon: \"edit\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 21\n            }\n          }, \"\\u4FEE\\u6539\"), /*#__PURE__*/React.createElement(Button, {\n            type: \"link\",\n            size: \"small\",\n            danger: true,\n            onClick: _this2.delMenu.bind(_this2, record),\n            icon: \"delete\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 21\n            }\n          }, \"\\u5220\\u9664\"));\n        }\n      }];\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n        type: \"primary\",\n        onClick: this.addMenu.bind(this, {\n          parentId: null\n        }),\n        className: \"query-tools\",\n        icon: \"add\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 17\n        }\n      }, \"\\u6DFB\\u52A0\\u4E00\\u7EA7\\u83DC\\u5355\"), /*#__PURE__*/React.createElement(Table, {\n        rowKey: \"menuId\",\n        number: false,\n        pager: false,\n        columns: columns,\n        data: this.state.data,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }\n      }), this.state.editDialog && /*#__PURE__*/React.createElement(Edit, {\n        parentId: this.state.parentId,\n        menuId: this.state.menuId,\n        onCancel: function onCancel() {\n          _this2.setState({\n            editDialog: false\n          });\n\n          _this2.getList();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 41\n        }\n      }));\n    }\n  }]);\n\n  return List;\n}(Component);\n\nexport default withRouter(List);","map":{"version":3,"sources":["E:/project/environment-web/src/pages/system/menu/List.js"],"names":["React","Component","withRouter","Button","Table","Edit","List","props","addMenu","parentId","menuId","setState","undefined","editDialog","delMenu","children","message","warning","confirm","axios","post","success","getList","get","res","data","delEmptyFiled","item","length","state","columns","title","dataIndex","key","width","align","render","text","record","fontSize","icon","enums","menuType","type","bind"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {withRouter} from \"react-router-dom\";\r\nimport Button from '@/components/button';\r\nimport Table from '@/components/table';\r\nimport Edit from './Edit';\r\nclass List extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            editDialog: false,\r\n            data: []\r\n        }\r\n    }\r\n    componentDidMount(){\r\n        this.getList();\r\n    }\r\n    addMenu=({parentId,menuId})=>{\r\n        this.setState({\r\n            parentId: parentId||undefined,\r\n            menuId: menuId,\r\n            editDialog:true\r\n        });\r\n    }\r\n    // 删除菜单\r\n    delMenu=({menuId,children})=>{\r\n        if(children){\r\n            React.message.warning('该菜单下有子菜单不能直接删除');\r\n            return;\r\n        }\r\n        React.message.confirm('确定删除该菜单？',()=>{\r\n            React.axios.post(`sys/menu/delete/${menuId}`,null,()=>{\r\n                React.message.success('删除成功');\r\n                this.getList();\r\n            })\r\n        });\r\n    }\r\n    // 获取列表数据\r\n    getList=()=>{\r\n        React.axios.get('sys/menu/menuTree',null,res=>{\r\n            this.setState({data: res.data});\r\n        })\r\n    }\r\n    // 去除菜单列表children为空的字段\r\n    delEmptyFiled=(data)=>{\r\n        for(let item of data){\r\n            if(item.children.length===0){\r\n                item.children = null;\r\n            }else{\r\n                this.delEmptyFiled(item.children);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n    render(){\r\n        const columns = [\r\n            {\r\n                title: '菜单名称',\r\n                dataIndex: 'name',\r\n                key: 'name',\r\n                width: '200px'\r\n            },\r\n            {\r\n                title: '图标',\r\n                width: '100px',\r\n                align: 'center',\r\n                render: (text, record)=><React.IconFont style={{fontSize: '22px'}} type={record.icon} />\r\n            },\r\n            {\r\n                title: '类型',\r\n                dataIndex: 'type',\r\n                key: 'type',\r\n                width: '100px',\r\n                render: (text, record)=><span>{React.enums.menuType[record.type]}</span>\r\n            },\r\n            {\r\n                title: '排序',\r\n                dataIndex: 'orderNum',\r\n                key: 'orderNum',\r\n                width: '100px',\r\n            },\r\n            {\r\n                title: '路由地址',\r\n                dataIndex: 'url',\r\n                key: 'url',\r\n            },\r\n            {\r\n                title: '权限标识',\r\n                dataIndex: 'perms',\r\n                key: 'perms',\r\n                width: '300px',\r\n            },\r\n            {\r\n                title: '操作',\r\n                width: '240px',\r\n                align: 'center',\r\n                render: (text, record)=><>\r\n                    <Button type=\"link\" size=\"small\" onClick={this.addMenu.bind(this,{parentId: record.menuId})} icon=\"add\">添加子菜单</Button>\r\n                    <Button type=\"link\" size=\"small\" onClick={this.addMenu.bind(this,{parentId: record.parentId,menuId: record.menuId})} icon=\"edit\">修改</Button>\r\n                    <Button type=\"link\" size=\"small\" danger onClick={this.delMenu.bind(this,record)} icon=\"delete\">删除</Button>\r\n                </>\r\n            }\r\n        ];\r\n        return(\r\n            <>\r\n                <Button type=\"primary\" onClick={this.addMenu.bind(this,{parentId: null})} className=\"query-tools\" icon=\"add\">添加一级菜单</Button>\r\n                <Table rowKey=\"menuId\" number={false} pager={false} columns={columns} data={this.state.data}/>\r\n                {this.state.editDialog&&<Edit parentId={this.state.parentId} menuId={this.state.menuId} onCancel={()=>{this.setState({editDialog: false});this.getList()}}/>}\r\n            </>\r\n        );\r\n    }\r\n}\r\nexport default withRouter(List);"]},"metadata":{},"sourceType":"module"}