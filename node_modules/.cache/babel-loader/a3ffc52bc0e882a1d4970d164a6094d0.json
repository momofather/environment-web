{"ast":null,"code":"import \"antd/es/card/style\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport _classCallCheck from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\project\\\\environment-web\\\\src\\\\pages\\\\login\\\\index.js\";\nimport React, { Component } from 'react';\nimport bgImg from '@/assets/images/login.png';\nimport './index.less';\nimport URL from '@/utils/url';\nvar sectionStyle = {\n  backgroundImage: \"url(\".concat(bgImg, \")\"),\n  backgroundSize: '100% 100%'\n};\n\nvar Login = /*#__PURE__*/function (_Component) {\n  _inherits(Login, _Component);\n\n  function Login() {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this));\n    _this.formRef = React.createRef();\n\n    _this.getCheckCode = function () {\n      _this.formRef.current.setFieldsValue({\n        captcha: null\n      });\n\n      var uuid = new Date().getTime().toString();\n\n      _this.setState({\n        url: \"\".concat(URL, \"numerCaptcha.jpg?uuid=\").concat(uuid),\n        uuid: uuid\n      });\n    };\n\n    _this.onFinish = function (values) {\n      values.uuid = _this.state.uuid;\n      sessionStorage.clear();\n      React.axios.post('sys/login', values, function (res) {\n        sessionStorage.setItem('token', res.token);\n\n        _this.getCurrentMenus();\n      }, function () {\n        _this.getCheckCode();\n      });\n    };\n\n    _this.getCurrentMenus = function () {\n      React.axios.get('sys/menu/nav', null, function (res) {\n        sessionStorage.setItem('menus', JSON.stringify(res.menuList));\n        sessionStorage.setItem('permissions', JSON.stringify(res.permissions));\n\n        if (res.menuList.length !== 0) {\n          _this.getFirstRouter(res.menuList, 0);\n        }\n\n        _this.props.history.push(\"/bigscreen\");\n      });\n    };\n\n    _this.state = {\n      url: null,\n      uuid: null\n    };\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      sessionStorage.clear();\n      this.getCheckCode();\n    }\n  }, {\n    key: \"getFirstRouter\",\n    value: function getFirstRouter(menus, index) {\n      if (menus[index].type === 1) {\n        sessionStorage.setItem('activi_router_path', menus[index].url);\n      } else {\n        this.getFirstRouter(menus[index].list, index);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var url = this.state.url;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"login-page\",\n        style: sectionStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Card, {\n        className: \"login-box\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 21\n        }\n      }, \"\\u6210\\u90FD\\u4E1C\\u5B89\\u6C34\\u8D28\\u51C0\\u5316\\u5382\\u751F\\u4EA7\\u8FD0\\u884C\\u76D1\\u6D4B\\u7CFB\\u7EDF\"), /*#__PURE__*/React.createElement(_Form, {\n        ref: this.formRef,\n        onFinish: this.onFinish,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        name: \"username\",\n        rules: [{\n          required: true,\n          message: '请输入用户名'\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        size: \"large\",\n        placeholder: \"\\u7528\\u6237\\u540D\",\n        prefix: /*#__PURE__*/React.createElement(\"span\", {\n          className: \"iconfont icon-yonghu\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 75\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 29\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        name: \"password\",\n        rules: [{\n          required: true,\n          message: '请输入密码'\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Input.Password, {\n        size: \"large\",\n        placeholder: \"\\u5BC6\\u7801\",\n        prefix: /*#__PURE__*/React.createElement(\"span\", {\n          className: \"iconfont icon-password\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 83\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 29\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        name: \"captcha\",\n        noStyle: true,\n        rules: [{\n          required: true,\n          message: '请输入验证码'\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        size: \"large\",\n        style: {\n          width: '190px'\n        },\n        placeholder: \"\\u9A8C\\u8BC1\\u7801\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 29\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        noStyle: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"check-code\",\n        onClick: this.getCheckCode,\n        alt: \"\\u9A8C\\u8BC1\\u7801\",\n        title: \"\\u70B9\\u51FB\\u5237\\u65B0\\u9A8C\\u8BC1\\u7801\",\n        src: url,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        size: \"large\",\n        type: \"primary\",\n        block: true,\n        htmlType: \"submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 29\n        }\n      }, \"\\u767B \\u5F55\")))));\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport default Login;","map":{"version":3,"sources":["E:/project/environment-web/src/pages/login/index.js"],"names":["React","Component","bgImg","URL","sectionStyle","backgroundImage","backgroundSize","Login","formRef","createRef","getCheckCode","current","setFieldsValue","captcha","uuid","Date","getTime","toString","setState","url","onFinish","values","state","sessionStorage","clear","axios","post","res","setItem","token","getCurrentMenus","get","JSON","stringify","menuList","permissions","length","getFirstRouter","props","history","push","menus","index","type","list","required","message","width"],"mappings":"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","sourcesContent":["import React, {Component } from 'react';\r\nimport bgImg from '@/assets/images/login.png';\r\nimport './index.less';\r\nimport { Card, Form, Input, Button } from 'antd';\r\nimport URL from '@/utils/url';\r\n\r\nconst sectionStyle = {\r\n    backgroundImage: `url(${bgImg})`,\r\n    backgroundSize: '100% 100%'\r\n};\r\nclass Login extends Component {\r\n    formRef = React.createRef();\r\n    constructor() {\r\n        super();\r\n        this.state={\r\n            url: null,\r\n            uuid: null\r\n        };\r\n    };\r\n\r\n    componentDidMount() {\r\n        sessionStorage.clear();\r\n        this.getCheckCode();\r\n    };\r\n\r\n    // 刷新验证码\r\n    getCheckCode=()=>{\r\n        this.formRef.current.setFieldsValue({captcha:null});\r\n        const uuid = new Date().getTime().toString();\r\n        this.setState({url: `${URL}numerCaptcha.jpg?uuid=${uuid}`,uuid: uuid});\r\n    }\r\n\r\n    onFinish=(values)=>{\r\n        values.uuid = this.state.uuid;\r\n        sessionStorage.clear();\r\n        React.axios.post('sys/login',values,res=>{\r\n            sessionStorage.setItem('token',res.token);\r\n            this.getCurrentMenus();\r\n        },()=>{\r\n            this.getCheckCode();\r\n        })\r\n    }\r\n    // 获取当前用户菜单及权限数据\r\n    getCurrentMenus=()=>{\r\n        React.axios.get('sys/menu/nav',null,res=>{\r\n            sessionStorage.setItem('menus',JSON.stringify(res.menuList));\r\n            sessionStorage.setItem('permissions',JSON.stringify(res.permissions));\r\n            if (res.menuList.length !== 0){\r\n                this.getFirstRouter(res.menuList, 0);\r\n            }\r\n            this.props.history.push(`/bigscreen`)\r\n        })\r\n    }\r\n    getFirstRouter(menus,index){\r\n        if(menus[index].type===1){\r\n            sessionStorage.setItem('activi_router_path',menus[index].url);\r\n        }else{\r\n            this.getFirstRouter(menus[index].list,index);\r\n        }\r\n    }\r\n    render() {\r\n        const {url} = this.state;\r\n\r\n        return(\r\n            <div className=\"login-page\" style={sectionStyle}>\r\n                <Card className=\"login-box\">\r\n                    <h1 className=\"title\">成都东安水质净化厂生产运行监测系统</h1>\r\n                    <Form ref={this.formRef} onFinish={this.onFinish}>\r\n                        <Form.Item name=\"username\" rules={[{ required: true, message: '请输入用户名' }]}>\r\n                            <Input size=\"large\" placeholder=\"用户名\" prefix={<span className=\"iconfont icon-yonghu\"></span>}/>\r\n                        </Form.Item>\r\n                        <Form.Item name=\"password\" rules={[{ required: true, message: '请输入密码' }]}>\r\n                            <Input.Password size=\"large\" placeholder=\"密码\" prefix={<span className=\"iconfont icon-password\"></span>}/>\r\n                        </Form.Item>\r\n                        <Form.Item>\r\n                            <Form.Item name=\"captcha\" noStyle rules={[{ required: true, message: '请输入验证码' }]}>\r\n                            <Input size=\"large\" style={{width: '190px'}} placeholder=\"验证码\"/>\r\n                            </Form.Item>\r\n                            <Form.Item noStyle>\r\n                            <img className=\"check-code\" onClick={this.getCheckCode} alt=\"验证码\" title=\"点击刷新验证码\" src={url}/>\r\n                            </Form.Item>\r\n                        </Form.Item>\r\n                        <Form.Item>\r\n                            <Button size=\"large\" type=\"primary\" block htmlType=\"submit\">登 录</Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </Card>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}