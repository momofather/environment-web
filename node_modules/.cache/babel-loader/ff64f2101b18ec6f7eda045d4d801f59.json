{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport \"antd/es/table/style\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/row/style\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/date-picker/style\";\nimport _DatePicker from \"antd/es/date-picker\";\nimport \"antd/es/col/style\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/input-number/style\";\nimport _InputNumber from \"antd/es/input-number\";\nimport \"antd/es/breadcrumb/style\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport _objectSpread from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\project\\\\environment-web\\\\src\\\\pages\\\\inventory\\\\outWarehouse\\\\components\\\\Edit.js\";\nimport React, { Component } from \"react\";\nimport moment from \"moment\";\nimport Button from \"@/components/button\";\nimport SelectGoods from \"./SelectGoods\";\n\nvar Edit = /*#__PURE__*/function (_Component) {\n  _inherits(Edit, _Component);\n\n  function Edit(props) {\n    var _this;\n\n    _classCallCheck(this, Edit);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Edit).call(this, props));\n    _this.formRef = React.createRef();\n\n    _this.getUnitList = function () {\n      React.axios.post('api/wmsType/tmaterialtype/queryMaterialTypeList?number=unit', null, function (res) {\n        var obj = {};\n        res.data.forEach(function (item) {\n          obj[item.id] = item.name;\n        });\n\n        _this.setState({\n          units: obj\n        });\n      });\n    };\n\n    _this.submit = function () {\n      var _this$props = _this.props,\n          id = _this$props.id,\n          tableReload = _this$props.tableReload;\n      var _this$state = _this.state,\n          username = _this$state.username,\n          goodsList = _this$state.goodsList,\n          totalprice = _this$state.totalprice;\n\n      _this.formRef.current.validateFields().then(function (values, errors) {\n        values.username = username;\n        values.housedate = values.housedate.format(\"YYYY-MM-DD\");\n        values.totalprice = totalprice;\n        values.number = _this.state.number;\n        values.warehouseOutorderEntity = goodsList;\n        values.type = \"1\";\n        React.axios.post(id ? \"/api/wms/twarehousebill/update\" : \"/api/wms/twarehousebill/save\", _objectSpread({\n          id: id\n        }, values), function (res) {\n          _this.close();\n\n          tableReload();\n        });\n      });\n    };\n\n    _this.close = function () {\n      var close = _this.props.close;\n      close();\n    };\n\n    _this.openSelectGoods = function () {\n      _this.setState({\n        selectGoodsVisible: true\n      });\n    };\n\n    _this.closeSelectGoods = function (reGoodsIds, reGoodsList) {\n      if (reGoodsList) {\n        _this.setState({\n          selectGoodsVisible: false,\n          goodsIds: reGoodsIds,\n          goodsList: reGoodsList\n        });\n\n        var totalprice = 0;\n        reGoodsList.forEach(function (item, index) {\n          totalprice += item.totalprice * 1;\n        });\n\n        _this.setState({\n          totalprice: totalprice\n        });\n      } else {\n        _this.setState({\n          selectGoodsVisible: false\n        });\n      }\n\n      ;\n    };\n\n    _this.chageNum = function (index, value) {\n      var goodsList = _this.state.goodsList;\n      goodsList[index].num = value;\n      goodsList[index].totalprice = goodsList[index].num * goodsList[index].price;\n\n      _this.setState({\n        goodsList: goodsList\n      });\n\n      _this.getTotalPrice();\n    };\n\n    _this.deleteGoods = function (index) {\n      var goodsList = _this.state.goodsList;\n      var newGoodsList = [];\n      goodsList.splice(index, 1);\n      goodsList.forEach(function (item) {\n        newGoodsList.push(item);\n      });\n\n      _this.setState({\n        goodsList: newGoodsList\n      });\n\n      _this.getTotalPrice();\n    };\n\n    _this.getTotalPrice = function () {\n      var goodsList = _this.state.goodsList;\n      var totalprice = 0;\n      goodsList.forEach(function (item, index) {\n        totalprice += item.totalprice * 1;\n      });\n\n      _this.setState({\n        totalprice: totalprice\n      });\n    };\n\n    _this.state = {\n      username: \"\",\n      userList: [],\n      selectGoodsVisible: false,\n      goodsIds: [],\n      goodsList: [],\n      outMothedList: [],\n      totalprice: 0,\n      units: {}\n    };\n    return _this;\n  }\n\n  _createClass(Edit, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.getUnitList();\n      var id = this.props.id;\n      React.axios.get(\"api/wms/twarehouse/list?limit=1000&page=1\", \"\", function (res) {\n        _this2.setState({\n          warehouseList: res.data.data\n        });\n      });\n      React.axios.get(\"sys/user/list\", \"\", function (res) {\n        _this2.setState({\n          userList: res.data.data\n        });\n      });\n      React.axios.post(\"api/wmsType/tmaterialtype/queryMaterialTypeList?number=\" + React.enums.outMethodCode, null, function (res) {\n        _this2.setState({\n          outMothedList: res.data\n        });\n      });\n\n      if (id) {\n        React.axios.get(\"api/wms/twarehousebill/info/\" + id, \"\", function (res) {\n          var goodsIds = [];\n\n          if (res.data.warehouseOutorderEntity) {\n            res.data.warehouseOutorderEntity.forEach(function (item) {\n              goodsIds.push(item.id);\n            });\n          }\n\n          ;\n\n          _this2.setState({\n            housename: res.data.housename,\n            goodsIds: goodsIds,\n            goodsList: res.data.warehouseOutorderEntity ? res.data.warehouseOutorderEntity : [],\n            totalprice: res.data.totalprice,\n            number: res.data.number\n          });\n\n          _this2.formRef.current.setFieldsValue(_objectSpread({}, res.data, {\n            housedate: moment(res.data.housedate)\n          }));\n        });\n      } else {\n        this.formRef.current.setFieldsValue({\n          housedate: moment()\n        });\n      }\n\n      ;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var id = this.props.id;\n      var _this$state2 = this.state,\n          userList = _this$state2.userList,\n          selectGoodsVisible = _this$state2.selectGoodsVisible,\n          goodsList = _this$state2.goodsList,\n          outMothedList = _this$state2.outMothedList,\n          totalprice = _this$state2.totalprice;\n      var formLayout = {\n        labelCol: {\n          xs: {\n            span: 24\n          },\n          sm: {\n            span: 24\n          },\n          md: {\n            span: 10\n          },\n          lg: {\n            span: 8\n          },\n          xl: {\n            span: 6\n          }\n        },\n        wrapperCol: {\n          xs: {\n            span: 24\n          },\n          sm: {\n            span: 24\n          },\n          md: {\n            span: 14\n          },\n          lg: {\n            span: 16\n          },\n          xl: {\n            span: 18\n          }\n        }\n      };\n      var tableColumns = [{\n        title: \"物料编号\",\n        key: \"number\",\n        dataIndex: \"number\"\n      }, {\n        title: \"物料名称\",\n        key: \"name\",\n        dataIndex: \"name\"\n      }, {\n        title: \"单价\",\n        key: \"price\",\n        dataIndex: \"price\",\n        render: function render(text, record) {\n          return \"\".concat(record.price, \"\\u5143/\").concat(_this3.state.units[record.unit]);\n        }\n      }, {\n        title: \"出库位置\",\n        render: function render(text, record) {\n          return /*#__PURE__*/React.createElement(_Breadcrumb, {\n            __self: _this3,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 21\n            }\n          }, /*#__PURE__*/React.createElement(_Breadcrumb.Item, {\n            __self: _this3,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 25\n            }\n          }, record.houseName), /*#__PURE__*/React.createElement(_Breadcrumb.Item, {\n            __self: _this3,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 25\n            }\n          }, record.locationName), /*#__PURE__*/React.createElement(_Breadcrumb.Item, {\n            __self: _this3,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 25\n            }\n          }, record.shelvesName));\n        }\n      }, {\n        title: \"数量\",\n        render: function render(text, record, index) {\n          return /*#__PURE__*/React.createElement(_InputNumber, {\n            value: record.num,\n            onChange: _this3.chageNum.bind(_this3, index),\n            min: 0,\n            __self: _this3,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 47\n            }\n          });\n        }\n      }, {\n        title: \"金额\",\n        key: \"totalprice\",\n        dataIndex: \"totalprice\"\n      }, {\n        title: \"操作\",\n        width: \"100px\",\n        render: function render(text, record, index) {\n          return /*#__PURE__*/React.createElement(Button, {\n            type: \"link\",\n            size: \"small\",\n            danger: true,\n            onClick: _this3.deleteGoods.bind(_this3, index),\n            icon: \"delete\",\n            __self: _this3,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 47\n            }\n          }, \"\\u5220\\u9664\");\n        }\n      }];\n      return /*#__PURE__*/React.createElement(_Modal, {\n        title: id ? \"修改出库信息\" : \"添加出库\",\n        visible: true,\n        onOk: this.submit,\n        onCancel: this.close,\n        width: 1080,\n        maskClosable: false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Space, {\n        direction: \"vertical\",\n        style: {\n          width: \"100%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(_Form, Object.assign({}, formLayout, {\n        ref: this.formRef,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(_Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Col, {\n        span: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u6807\\u9898\",\n        name: \"name\",\n        initialValue: \"\",\n        rules: [{\n          required: true,\n          message: \"标题不能为空\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        placeholder: \"\\u6807\\u9898\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 37\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u7ECF\\u624B\\u4EBA\",\n        name: \"userno\",\n        initialValue: [],\n        rules: [{\n          required: true,\n          message: \"经手人不能为空\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(_Select, {\n        placeholder: \"\\u7ECF\\u624B\\u4EBA\",\n        onChange: function onChange(value, event) {\n          _this3.setState({\n            username: event.children\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 37\n        }\n      }, userList.map(function (item, index) {\n        return /*#__PURE__*/React.createElement(_Select.Option, {\n          key: item.userId.toString(),\n          value: item.userId.toString(),\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 49\n          }\n        }, item.name);\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u5907\\u6CE8\",\n        name: \"remark\",\n        initialValue: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(_Input.TextArea, {\n        placeholder: \"100\\u4E2A\\u5B57\\u4EE5\\u5185\",\n        maxLength: 100,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 37\n        }\n      }))), /*#__PURE__*/React.createElement(_Col, {\n        span: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u51FA\\u5E93\\u65E5\\u671F\",\n        name: \"housedate\",\n        initialValue: \"\",\n        rules: [{\n          required: true,\n          message: \"出库日期不能为空\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(_DatePicker, {\n        style: {\n          width: \"100%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 37\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u51FA\\u5E93\\u65B9\\u5F0F\",\n        name: \"deliverymode\",\n        initialValue: [],\n        rules: [{\n          required: true,\n          message: \"出库方式不能为空\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(_Select, {\n        placeholder: \"\\u51FA\\u5E93\\u65B9\\u5F0F\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 37\n        }\n      }, outMothedList.map(function (item) {\n        return /*#__PURE__*/React.createElement(_Select.Option, {\n          key: item.id,\n          value: item.id,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 45\n          }\n        }, item.name);\n      })))))), /*#__PURE__*/React.createElement(Button, {\n        type: \"link\",\n        onClick: this.openSelectGoods,\n        icon: \"add\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 21\n        }\n      }, \"\\u9009\\u62E9\\u7269\\u6599\"), /*#__PURE__*/React.createElement(_Table, {\n        bordered: true,\n        rowKey: \"inventoryId\",\n        columns: tableColumns,\n        dataSource: goodsList,\n        paganizition: false,\n        number: false,\n        footer: function footer() {\n          return \"总金额：\" + totalprice;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 21\n        }\n      })), selectGoodsVisible && /*#__PURE__*/React.createElement(SelectGoods, {\n        ids: this.state.goodsIds,\n        list: this.state.goodsList,\n        close: this.closeSelectGoods,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 40\n        }\n      }));\n    }\n  }]);\n\n  return Edit;\n}(Component);\n\n;\nexport default Edit;","map":{"version":3,"sources":["E:/project/environment-web/src/pages/inventory/outWarehouse/components/Edit.js"],"names":["React","Component","moment","Button","SelectGoods","Edit","props","formRef","createRef","getUnitList","axios","post","res","obj","data","forEach","item","id","name","setState","units","submit","tableReload","state","username","goodsList","totalprice","current","validateFields","then","values","errors","housedate","format","number","warehouseOutorderEntity","type","close","openSelectGoods","selectGoodsVisible","closeSelectGoods","reGoodsIds","reGoodsList","goodsIds","index","chageNum","value","num","price","getTotalPrice","deleteGoods","newGoodsList","splice","push","userList","outMothedList","get","warehouseList","enums","outMethodCode","housename","setFieldsValue","formLayout","labelCol","xs","span","sm","md","lg","xl","wrapperCol","tableColumns","title","key","dataIndex","render","text","record","unit","houseName","locationName","shelvesName","bind","width","required","message","event","children","map","userId","toString"],"mappings":"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","sourcesContent":["import React,{Component} from \"react\";\r\nimport {Modal,Form,Input,Select,Row,Col,DatePicker,Space,Table,InputNumber,Breadcrumb} from \"antd\";\r\nimport moment from \"moment\";\r\n\r\nimport Button from \"@/components/button\";\r\n\r\nimport SelectGoods from \"./SelectGoods\";\r\n\r\nclass Edit extends Component{\r\n    formRef = React.createRef();\r\n    constructor(props){\r\n        super(props);\r\n        this.state={\r\n            username:\"\",\r\n            userList:[],\r\n            selectGoodsVisible:false,\r\n            goodsIds:[],\r\n            goodsList:[],\r\n            outMothedList:[],\r\n            totalprice:0,\r\n            units: {}\r\n        };\r\n    };\r\n\r\n    componentDidMount(){\r\n        this.getUnitList();\r\n        const {id} = this.props;\r\n        React.axios.get(\"api/wms/twarehouse/list?limit=1000&page=1\",\"\",res => {\r\n            this.setState({warehouseList:res.data.data});\r\n        });\r\n        React.axios.get(\"sys/user/list\",\"\",res => {\r\n            this.setState({userList:res.data.data});\r\n        });\r\n        React.axios.post(\"api/wmsType/tmaterialtype/queryMaterialTypeList?number=\"+React.enums.outMethodCode,null,res => {\r\n            this.setState({outMothedList:res.data});\r\n        });\r\n        if(id){\r\n            React.axios.get(\"api/wms/twarehousebill/info/\"+id,\"\",res => {\r\n                let goodsIds = [];\r\n                if(res.data.warehouseOutorderEntity){\r\n                    res.data.warehouseOutorderEntity.forEach((item) => {\r\n                        goodsIds.push(item.id);\r\n                    });\r\n                };\r\n                this.setState({\r\n                    housename:res.data.housename,\r\n                    goodsIds,\r\n                    goodsList:res.data.warehouseOutorderEntity ? (res.data.warehouseOutorderEntity) : ([]),totalprice:res.data.totalprice,\r\n                    number: res.data.number\r\n                });\r\n                this.formRef.current.setFieldsValue({...res.data,housedate:moment(res.data.housedate)});\r\n            });\r\n        }else{\r\n            this.formRef.current.setFieldsValue({housedate:moment()});\r\n        };\r\n    };\r\n    // 获取计量单位\r\n    getUnitList=()=>{\r\n        React.axios.post('api/wmsType/tmaterialtype/queryMaterialTypeList?number=unit',null,res=>{\r\n            let obj = {};\r\n            res.data.forEach(item=>{\r\n                obj[item.id] = item.name;\r\n            })\r\n            this.setState({units: obj});\r\n        })\r\n    }\r\n\r\n    /**\r\n     * @todo 提交表单\r\n     */\r\n    submit = () => {\r\n        const {id,tableReload} = this.props;\r\n        const {username,goodsList,totalprice} = this.state;\r\n        this.formRef.current.validateFields().then((values,errors) => {\r\n            values.username = username;\r\n            values.housedate = values.housedate.format(\"YYYY-MM-DD\");\r\n            values.totalprice = totalprice;\r\n            values.number = this.state.number;\r\n            values.warehouseOutorderEntity = goodsList;\r\n            values.type = \"1\";\r\n            React.axios.post(id ? (\"/api/wms/twarehousebill/update\") : (\"/api/wms/twarehousebill/save\"),{id,...values},res => {\r\n                this.close();\r\n                tableReload();\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * @todo 关闭组件\r\n     */\r\n    close = () => {\r\n        const {close} = this.props;\r\n        close();\r\n    };\r\n\r\n    /**\r\n     * @todo 打开选择物料模态框\r\n     */\r\n    openSelectGoods = () => {\r\n        this.setState({selectGoodsVisible: true});\r\n    };\r\n\r\n    /**\r\n     * @todo 关闭选择物料模态框\r\n     */\r\n    closeSelectGoods = (reGoodsIds,reGoodsList) => {\r\n        if(reGoodsList){\r\n            this.setState({selectGoodsVisible: false,goodsIds:reGoodsIds,goodsList:reGoodsList});\r\n            let totalprice = 0;\r\n            reGoodsList.forEach((item,index) => {\r\n                totalprice += item.totalprice * 1;\r\n            });\r\n            this.setState({totalprice});\r\n        }else{\r\n            this.setState({selectGoodsVisible:false});\r\n        };\r\n    };\r\n\r\n    /**\r\n     * @todo 改变物料数量\r\n     */\r\n    chageNum = (index,value) => {\r\n        let {goodsList} = this.state;\r\n        goodsList[index].num = value;\r\n        goodsList[index].totalprice = goodsList[index].num * goodsList[index].price;\r\n        this.setState({goodsList});\r\n        this.getTotalPrice();\r\n    };\r\n\r\n    /**\r\n     * @todo 删除物料\r\n     */\r\n    deleteGoods = (index) => {\r\n        let {goodsList} = this.state;\r\n        let newGoodsList = [];\r\n        goodsList.splice(index,1);\r\n        goodsList.forEach((item) => {\r\n            newGoodsList.push(item);\r\n        });\r\n        this.setState({goodsList:newGoodsList});\r\n        this.getTotalPrice();\r\n    };\r\n\r\n    /**\r\n     * @todo 获取总金额\r\n     */\r\n    getTotalPrice = () => {\r\n        const {goodsList} = this.state;\r\n        let totalprice = 0;\r\n        goodsList.forEach((item,index) => {\r\n            totalprice += item.totalprice * 1;\r\n        });\r\n        this.setState({totalprice});\r\n    };\r\n\r\n    render(){\r\n        const {id} = this.props;\r\n        const {userList,selectGoodsVisible,goodsList,outMothedList,totalprice} = this.state;\r\n\r\n        const formLayout={\r\n            labelCol:{\r\n                xs:{span:24},\r\n                sm:{span:24},\r\n                md:{span:10},\r\n                lg:{span:8},\r\n                xl:{span:6},\r\n            },\r\n            wrapperCol:{\r\n                xs:{span:24},\r\n                sm:{span:24},\r\n                md:{span:14},\r\n                lg:{span:16},\r\n                xl:{span:18},\r\n            }\r\n        };\r\n\r\n        const tableColumns = [\r\n            {\r\n                title:\"物料编号\",\r\n                key:\"number\",\r\n                dataIndex:\"number\",\r\n            },\r\n            {\r\n                title:\"物料名称\",\r\n                key:\"name\",\r\n                dataIndex:\"name\",\r\n            },\r\n            {\r\n                title:\"单价\",\r\n                key:\"price\",\r\n                dataIndex:\"price\",\r\n                render:(text,record) => `${record.price}元/${this.state.units[record.unit]}`\r\n            },\r\n            {\r\n                title:\"出库位置\",\r\n                render:(text,record) =>\r\n                    <Breadcrumb>\r\n                        <Breadcrumb.Item>{record.houseName}</Breadcrumb.Item>\r\n                        <Breadcrumb.Item>{record.locationName}</Breadcrumb.Item>\r\n                        <Breadcrumb.Item>{record.shelvesName}</Breadcrumb.Item>\r\n                    </Breadcrumb>\r\n            },\r\n            {\r\n                title:\"数量\",\r\n                render:(text,record,index) => <InputNumber value={record.num} onChange={this.chageNum.bind(this,index)} min={0}/>,\r\n            },\r\n            {\r\n                title:\"金额\",\r\n                key:\"totalprice\",\r\n                dataIndex:\"totalprice\",\r\n            },\r\n            {\r\n                title:\"操作\",\r\n                width:\"100px\",\r\n                render:(text,record,index) => <Button type=\"link\" size=\"small\" danger onClick={this.deleteGoods.bind(this,index)} icon=\"delete\">删除</Button>,\r\n            },\r\n        ];\r\n\r\n        return(\r\n            <Modal\r\n                title={id ? (\"修改出库信息\") : (\"添加出库\")}\r\n                visible={true}\r\n                onOk={this.submit}\r\n                onCancel={this.close}\r\n                width={1080}\r\n                maskClosable={false}\r\n            >\r\n                <Space\r\n                    direction=\"vertical\"\r\n                    style={{width:\"100%\"}}\r\n                >\r\n                    <Form\r\n                        {...formLayout}\r\n                        ref={this.formRef}\r\n                    >\r\n                        <Row>\r\n                            <Col span={12}>\r\n                                <Form.Item\r\n                                    label=\"标题\"\r\n                                    name=\"name\"\r\n                                    initialValue=\"\"\r\n                                    rules={[\r\n                                        {required:true,message:\"标题不能为空\"}\r\n                                    ]}\r\n                                >\r\n                                    <Input placeholder=\"标题\"/>\r\n                                </Form.Item>\r\n                                <Form.Item\r\n                                    label=\"经手人\"\r\n                                    name=\"userno\"\r\n                                    initialValue={[]}\r\n                                    rules={[\r\n                                        {required:true,message:\"经手人不能为空\"}\r\n                                    ]}\r\n                                >\r\n                                    <Select\r\n                                        placeholder=\"经手人\"\r\n                                        onChange={(value,event) => {this.setState({username:event.children})}}\r\n                                    >\r\n                                        {userList.map((item,index) => {\r\n                                            return(\r\n                                                <Select.Option\r\n                                                    key={item.userId.toString()}\r\n                                                    value={item.userId.toString()}\r\n                                                >\r\n                                                    {item.name}\r\n                                                </Select.Option>\r\n                                            );\r\n                                        })}\r\n                                    </Select>\r\n                                </Form.Item>\r\n                                <Form.Item\r\n                                    label=\"备注\"\r\n                                    name=\"remark\"\r\n                                    initialValue=\"\"\r\n                                >\r\n                                    <Input.TextArea placeholder=\"100个字以内\" maxLength={100}/>\r\n                                </Form.Item>\r\n                            </Col>\r\n                            <Col span={12}>\r\n                                <Form.Item\r\n                                    label=\"出库日期\"\r\n                                    name=\"housedate\"\r\n                                    initialValue=\"\"\r\n                                    rules={[\r\n                                        {required:true,message:\"出库日期不能为空\"}\r\n                                    ]}\r\n                                >\r\n                                    <DatePicker style={{width:\"100%\"}}/>\r\n                                </Form.Item>\r\n                                <Form.Item\r\n                                    label=\"出库方式\"\r\n                                    name=\"deliverymode\"\r\n                                    initialValue={[]}\r\n                                    rules={[\r\n                                        {required:true,message:\"出库方式不能为空\"}\r\n                                    ]}\r\n                                >\r\n                                    <Select\r\n                                        placeholder=\"出库方式\"\r\n                                    >\r\n                                        {outMothedList.map((item) =>\r\n                                            <Select.Option\r\n                                                key={item.id}\r\n                                                value={item.id}\r\n                                            >\r\n                                                {item.name}\r\n                                            </Select.Option>\r\n                                        )}\r\n                                    </Select>\r\n                                </Form.Item>\r\n                            </Col>\r\n                        </Row>\r\n                    </Form>\r\n                    <Button type=\"link\" onClick={this.openSelectGoods} icon=\"add\">选择物料</Button>\r\n                    <Table\r\n                        bordered\r\n                        rowKey=\"inventoryId\"\r\n                        columns={tableColumns}\r\n                        dataSource={goodsList}\r\n                        paganizition={false}\r\n                        number={false}\r\n                        footer={() => \"总金额：\"+totalprice}\r\n                    />\r\n                </Space>\r\n                {selectGoodsVisible && <SelectGoods ids={this.state.goodsIds} list={this.state.goodsList} close={this.closeSelectGoods}/>}\r\n            </Modal>\r\n        );\r\n    };\r\n};\r\nexport default Edit;"]},"metadata":{},"sourceType":"module"}