{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport _classCallCheck from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\project\\\\environment-web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\project\\\\environment-web\\\\src\\\\pages\\\\device\\\\info\\\\Edit.js\";\nimport React, { Component } from 'react';\nimport './Edit.less';\n\nvar List = /*#__PURE__*/function (_Component) {\n  _inherits(List, _Component);\n\n  function List(props) {\n    var _this;\n\n    _classCallCheck(this, List);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(List).call(this, props));\n    _this.formRef = React.createRef();\n\n    _this.beforeUpload = function (file) {\n      var formData = new FormData();\n      formData.append('file', file);\n      React.axios.upload(formData, function (res) {\n        _this.setState({\n          imageUrl: res.url\n        });\n      });\n      return false;\n    };\n\n    _this.getUnitList = function () {\n      React.axios.post('api/wmsType/tmaterialtype/queryMaterialTypeList?number=unit', null, function (res) {\n        _this.setState({\n          units: res.data\n        });\n      });\n    };\n\n    _this.submit = function () {\n      _this.formRef.current.validateFields().then(function (values, errors) {\n        var api = 'api/device/deviceinfo/save';\n\n        if (_this.state.id) {\n          api = 'api/device/deviceinfo/update';\n          values.id = _this.state.id;\n        }\n\n        React.axios.post(api, values, function () {\n          React.message.success('操作成功');\n\n          _this.props.onOk();\n        });\n      });\n    };\n\n    _this.getInfo = function () {\n      if (_this.state.id) {\n        React.axios.get(\"api/device/deviceinfo/info/\".concat(_this.state.id), null, function (res) {\n          _this.formRef.current.setFieldsValue(res.data);\n        });\n      }\n    };\n\n    _this.state = {\n      id: _this.props.id,\n      imageUrl: null,\n      units: []\n    };\n    return _this;\n  }\n\n  _createClass(List, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getUnitList();\n      this.getInfo();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(_Modal, {\n        title: \"\\u6DFB\\u52A0\\u8BBE\\u5907\",\n        visible: true,\n        onCancel: this.props.onCancel,\n        onOk: this.submit,\n        maskClosable: false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Form, {\n        className: \"form\",\n        ref: this.formRef,\n        labelCol: {\n          span: 4\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u901A\\u9053\\u540D\\u79F0\",\n        name: \"channelName\",\n        rules: [{\n          required: true,\n          message: \"请输入通道名称\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u901A\\u9053\\u540D\\u79F0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u8BBE\\u5907\\u540D\\u79F0\",\n        name: \"deviceName\",\n        rules: [{\n          required: true,\n          message: \"请输入设备名称\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u8BBE\\u5907\\u540D\\u79F0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u6807\\u7B7E\\u540D\",\n        name: \"tagName\",\n        rules: [{\n          required: true,\n          message: \"请输入标签名\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u6807\\u7B7E\\u540D\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u6570\\u636E\\u7C7B\\u578B\",\n        name: \"dataType\",\n        rules: [{\n          required: true,\n          message: \"请选择数据类型\"\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Select, {\n        placeholder: \"\\u6570\\u636E\\u7C7B\\u578B\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(_Select.Option, {\n        value: \"Float\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 29\n        }\n      }, \"Float\"), /*#__PURE__*/React.createElement(_Select.Option, {\n        value: \"Boolean\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 29\n        }\n      }, \"Boolean\"), /*#__PURE__*/React.createElement(_Select.Option, {\n        value: \"Long\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 29\n        }\n      }, \"Long\"))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"\\u63CF\\u8FF0\",\n        name: \"describe\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(_Input.TextArea, {\n        placeholder: \"100\\u4E2A\\u5B57\\u4EE5\\u5185\",\n        maxLength: 100,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 25\n        }\n      }))));\n    }\n  }]);\n\n  return List;\n}(Component);\n\nexport { List as default };","map":{"version":3,"sources":["E:/project/environment-web/src/pages/device/info/Edit.js"],"names":["React","Component","List","props","formRef","createRef","beforeUpload","file","formData","FormData","append","axios","upload","res","setState","imageUrl","url","getUnitList","post","units","data","submit","current","validateFields","then","values","errors","api","state","id","message","success","onOk","getInfo","get","setFieldsValue","onCancel","span","required"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Form, Input, Modal, Select } from 'antd';\r\nimport './Edit.less';\r\nexport default class List extends Component{\r\n    formRef = React.createRef();\r\n    constructor(props){\r\n        super(props);\r\n        this.state={\r\n            id: this.props.id,\r\n            imageUrl: null,\r\n            units: []\r\n        }\r\n    }\r\n    componentDidMount(){\r\n        this.getUnitList();\r\n        this.getInfo();\r\n    }\r\n    beforeUpload=(file)=>{\r\n        let formData = new FormData();\r\n        formData.append('file',file);\r\n        React.axios.upload(formData,res=>{\r\n            this.setState({\r\n                imageUrl: res.url\r\n            })\r\n        })\r\n        return false;\r\n    }\r\n    // 获取计量单位\r\n    getUnitList=()=>{\r\n        React.axios.post('api/wmsType/tmaterialtype/queryMaterialTypeList?number=unit',null,res=>{\r\n            this.setState({units: res.data});\r\n        })\r\n    }\r\n    // 保存\r\n    submit=()=>{\r\n        this.formRef.current.validateFields().then((values, errors) => {\r\n            let api = 'api/device/deviceinfo/save';\r\n            if (this.state.id) {\r\n                api = 'api/device/deviceinfo/update';\r\n                values.id = this.state.id;\r\n            }\r\n            React.axios.post(api, values, () => {\r\n                React.message.success('操作成功');\r\n                this.props.onOk();\r\n            })\r\n        });\r\n        \r\n    }\r\n    // 根据id查询\r\n    getInfo=()=>{\r\n        if(this.state.id){\r\n            React.axios.get(`api/device/deviceinfo/info/${this.state.id}`,null,res=>{\r\n                this.formRef.current.setFieldsValue(res.data);\r\n            })\r\n        }\r\n    }\r\n    render() {\r\n        return (\r\n            <Modal title=\"添加设备\" visible={true} onCancel={this.props.onCancel} onOk={this.submit} maskClosable={false}>\r\n                <Form className=\"form\" ref={this.formRef} labelCol={{ span: 4 }}>\r\n                    <Form.Item label=\"通道名称\" name=\"channelName\" rules={[{ required: true, message: \"请输入通道名称\" }]}>\r\n                        <Input placeholder=\"请输入通道名称\" />\r\n                    </Form.Item>\r\n                    <Form.Item label=\"设备名称\" name=\"deviceName\" rules={[{ required: true, message: \"请输入设备名称\" }]}>\r\n                        <Input placeholder=\"请输入设备名称\" />\r\n                    </Form.Item>\r\n                    <Form.Item label=\"标签名\" name=\"tagName\" rules={[{ required: true, message: \"请输入标签名\" }]}>\r\n                        <Input placeholder=\"请输入标签名\" />\r\n                    </Form.Item>\r\n                    <Form.Item label=\"数据类型\" name=\"dataType\" rules={[{ required: true, message: \"请选择数据类型\" }]}>\r\n                        <Select placeholder=\"数据类型\">\r\n                            <Select.Option value=\"Float\">Float</Select.Option>\r\n                            <Select.Option value=\"Boolean\">Boolean</Select.Option>\r\n                            <Select.Option value=\"Long\">Long</Select.Option>\r\n                        </Select>\r\n                    </Form.Item>\r\n                    <Form.Item label=\"描述\" name=\"describe\">\r\n                        <Input.TextArea placeholder=\"100个字以内\" maxLength={100} />\r\n                    </Form.Item>\r\n                </Form>\r\n            </Modal>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}